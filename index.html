<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Solution Book</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --background-color: #f5f7fa;
            --text-color: #333;
            --light-text: #666;
            --border-color: #ddd;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --error-color: #dc3545;
            --light-bg: rgba(255, 255, 255, 0.7);
            --header-height: 60px;
            --sidebar-width: 250px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            height: var(--header-height);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
            padding: 0 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .menu-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: background-color 0.3s;
        }

        .menu-toggle:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .auth-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .auth-buttons select {
            padding: 8px 15px;
            border-radius: 4px;
            border: none;
            background-color: white;
            color: var(--primary-color);
            font-weight: bold;
        }

        .auth-buttons button {
            background-color: white;
            color: var(--primary-color);
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .page {
            display: none;
            min-height: calc(100vh - var(--header-height));
            margin-top: var(--header-height);
            padding: 20px 0;
        }

        .active-page {
            display: block;
        }

        /* Role Selection Dropdown */
        .role-dropdown-container {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .role-dropdown-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .role-dropdown h2 {
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .role-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 20px;
            background-color: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .role-select:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .role-submit-btn {
            background: linear-gradient(to right, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .role-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        /* Login Form */
        .login-form {
            display: none;
            margin-top: 20px;
            text-align: left;
        }

        .login-form.active {
            display: block;
        }

        .login-form h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(74, 111, 165, 0.2);
        }

        .btn {
            padding: 12px 25px;
            background: linear-gradient(to right, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary {
            background: linear-gradient(to right, #f093fb 0%, #f5576c 100%);
            margin-left: 10px;
        }

        /* Menu */
        .menu {
            position: fixed;
            top: var(--header-height);
            left: -300px;
            width: 300px;
            height: calc(100vh - var(--header-height));
            background-color: white;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            transition: left 0.3s ease;
            z-index: 999;
            padding: 20px;
            overflow-y: auto;
        }

        .menu.active {
            left: 0;
        }

        .menu-section {
            margin-bottom: 20px;
        }

        .menu-section h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
        }

        .menu-option {
            display: flex;
            align-items: center;
            padding: 10px;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .menu-option:hover {
            background-color: var(--light-bg);
        }

        .menu-option i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .menu-divider {
            height: 1px;
            background-color: var(--border-color);
            margin: 15px 0;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .action-btn {
            flex: 1;
            text-align: center;
            padding: 15px 10px;
            margin: 0 5px;
            background: linear-gradient(to right, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .action-btn:active {
            transform: translateY(0);
        }

        /* Admin Dashboard */
        .admin-layout {
            display: flex;
            gap: 20px;
        }

        .admin-sidebar {
            width: var(--sidebar-width);
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            height: fit-content;
        }

        .admin-content {
            flex: 1;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chapters-list {
            list-style-type: none;
        }

        .chapter-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chapter-item.active {
            background-color: var(--light-bg);
            font-weight: bold;
        }

        .chapter-item:last-child {
            border-bottom: none;
        }

        .questions-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .question-item {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .question-number {
            font-weight: bold;
            color: var(--primary-color);
        }

        .question-actions button {
            margin-left: 5px;
            padding: 5px 10px;
            font-size: 12px;
        }

        .solution-content {
            margin-top: 10px;
            padding: 10px;
            background-color: var(--light-bg);
            border-radius: 4px;
        }

        .image-preview {
            max-width: 100%;
            margin-top: 10px;
            border-radius: 4px;
            max-height: 200px;
            object-fit: contain;
        }

        .add-question-form, .edit-question-form {
            background-color: var(--light-bg);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        /* Student Dashboard */
        .student-chapters {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .student-chapter-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .student-chapter-card:hover {
            transform: translateY(-5px);
        }

        .student-chapter-card h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .questions-list {
            margin-top: 20px;
        }

        .student-question-item {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .student-question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .solution-toggle {
            color: var(--primary-color);
            cursor: pointer;
            font-weight: bold;
        }

        .student-solution {
            margin-top: 15px;
            padding: 15px;
            background-color: var(--light-bg);
            border-radius: 8px;
            display: none;
        }

        .student-solution.active {
            display: block;
        }

        .remark-section {
            margin-top: 15px;
            border-top: 1px dashed var(--border-color);
            padding-top: 15px;
        }

        .remark-btn {
            background: none;
            border: none;
            color: var(--secondary-color);
            cursor: pointer;
            font-size: 14px;
        }

        .comment-form {
            margin-top: 10px;
            display: none;
        }

        .comment-form.active {
            display: block;
        }

        .share-options {
            margin-top: 15px;
            display: none;
        }

        .share-options.active {
            display: block;
        }

        /* Content Area */
        .content-area {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            min-height: 400px;
        }
        
        .form-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .chapter-list, .section-list {
            margin-top: 20px;
        }
        
        .chapter-item, .section-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chapter-title, .section-title {
            font-weight: 600;
            font-size: 18px;
        }
        
        .action-icons {
            display: flex;
        }
        
        .icon-btn {
            background: none;
            border: none;
            font-size: 18px;
            margin-left: 10px;
            cursor: pointer;
            color: #6c757d;
            transition: color 0.3s;
        }
        
        .icon-btn:hover {
            color: var(--primary-color);
        }
        
        .question-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
                .question-action-btn {
            flex: 1;
            margin: 0 5px;
            padding: 12px;
            background: linear-gradient(to right, #43e97b 0%, #38f9d7 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .question-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .hidden {
            display: none;
        }
        
        .active-form {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
        }

        /* Image Upload Styles */
        .image-upload-container {
            margin-top: 10px;
        }

        .image-preview-container {
            margin-top: 10px;
            text-align: center;
        }

        .image-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 4px;
            margin-top: 10px;
            display: none;
        }

        .image-preview.active {
            display: inline-block;
        }

        /* Settings Page */
        .settings-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .settings-option {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
            cursor: pointer;
            transition: all 0.3s;
        }

        .settings-option:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .settings-option h3 {
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .admin-layout {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
            }
            
            .student-chapters {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .action-btn {
                margin: 5px 0;
            }
            
            .question-actions {
                flex-direction: column;
            }
            
            .question-action-btn {
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <button class="menu-toggle" id="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">Math Solution Book</div>
            <div class="auth-buttons">
                <!-- Empty for alignment -->
            </div>
        </div>
    </header>

    <!-- Menu -->
    <div class="menu" id="menu">
        <div class="menu-section">
            <h3>Navigation</h3>
            <div class="menu-option" id="menu-home">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </div>
            <div class="menu-option" id="menu-chapters">
                <i class="fas fa-book"></i>
                <span>Chapters</span>
            </div>
            <div class="menu-option" id="menu-questions">
                <i class="fas fa-question-circle"></i>
                <span>Questions</span>
            </div>
        </div>
        
        <div class="menu-section">
            <h3>Account</h3>
            <div class="menu-option" id="menu-profile">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
            <div class="menu-option" id="menu-settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </div>
        
        <div class="menu-section">
            <h3>Help</h3>
            <div class="menu-option" id="menu-help">
                <i class="fas fa-question"></i>
                <span>Help & Support</span>
            </div>
            <div class="menu-option" id="menu-about">
                <i class="fas fa-info-circle"></i>
                <span>About</span>
            </div>
        </div>
        
        <div class="menu-divider"></div>
        
        <div class="menu-option" id="menu-logout">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
        </div>
    </div>

    <!-- Role Selection Dropdown -->
    <div class="role-dropdown-container" id="role-dropdown">
        <div class="role-dropdown-content">
            <h2>Select Your Role</h2>
            <select class="role-select" id="role-select">
                <option value="">-- Select Role --</option>
                <option value="admin">Admin</option>
                <option value="student">Student</option>
            </select>
            <button class="role-submit-btn" id="role-submit-btn">Continue</button>
            
            <!-- Login Form -->
            <div class="login-form" id="login-form">
                <h3 id="login-title">Login</h3>
                <div class="form-group">
                    <label for="login-username">Username</label>
                    <input type="text" id="login-username" class="form-control" placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" class="form-control" placeholder="Enter your password">
                </div>
                <button class="btn" id="login-btn">Login</button>
                <button class="btn btn-secondary" id="back-to-role">Back</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Admin Dashboard -->
        <div id="admin-dashboard" class="page">
            <div class="quick-actions">
                <button class="action-btn" id="addChapterBtn">Add New Chapter</button>
                <button class="action-btn" id="addSectionBtn">Add New Section</button>
                <button class="action-btn" id="addQuestionBtn">Add New Question</button>
            </div>
            
            <div class="content-area">
                <div id="defaultView">
                    <h2>Chapters</h2>
                    <div class="chapter-list" id="chapterList">
                        <!-- Chapters will be dynamically added here -->
                    </div>
                </div>
                
                <div id="addChapterForm" class="form-container hidden">
                    <h2>Add New Chapter</h2>
                    <div class="form-group">
                        <label for="chapterName">Chapter Name</label>
                        <input type="text" id="chapterName" class="form-control" placeholder="Enter chapter name">
                    </div>
                    <button class="btn" id="saveChapterBtn">Save Chapter</button>
                    <button class="btn btn-secondary" id="cancelChapterBtn">Cancel</button>
                </div>
                                <div id="addSectionForm" class="form-container hidden">
                    <h2>Add New Section</h2>
                    <div class="form-group">
                        <label for="sectionChapterSelect">Select Chapter</label>
                        <select id="sectionChapterSelect" class="form-control">
                            <!-- Chapters will be dynamically added here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sectionName">Section Name</label>
                        <input type="text" id="sectionName" class="form-control" placeholder="Enter section name">
                    </div>
                    <button class="btn" id="saveSectionBtn">Save Section</button>
                    <button class="btn btn-secondary" id="cancelSectionBtn">Cancel</button>
                </div>
                
                <div id="addQuestionForm" class="form-container hidden">
                    <h2>Add New Question</h2>
                    <div class="form-group">
                        <label for="questionChapterSelect">Select Chapter</label>
                        <select id="questionChapterSelect" class="form-control">
                            <!-- Chapters will be dynamically added here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="questionSectionSelect">Select Section</label>
                        <select id="questionSectionSelect" class="form-control">
                            <!-- Sections will be dynamically added here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="questionNumber">Question Number</label>
                        <input type="text" id="questionNumber" class="form-control" placeholder="e.g., 1.1">
                    </div>
                    <div class="form-group">
                        <label for="questionText">Question</label>
                        <textarea id="questionText" class="form-control" rows="4" placeholder="Enter question"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="answerText">Solution</label>
                        <textarea id="answerText" class="form-control" rows="4" placeholder="Enter solution"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="questionImage">Add Image</label>
                        <input type="file" id="questionImage" class="form-control" accept="image/*">
                        <div class="image-upload-container">
                            <div class="image-preview-container">
                                <img id="imagePreview" class="image-preview" src="" alt="Image Preview">
                            </div>
                        </div>
                    </div>
                    <button class="btn" id="saveQuestionBtn">Save Question</button>
                    <button class="btn btn-secondary" id="cancelQuestionBtn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Student Dashboard -->
        <div id="student-dashboard" class="page">
            <h2>Math Solution Book</h2>
            <div id="student-chapters" class="student-chapters">
                <!-- Chapters will be dynamically added here -->
            </div>
            
            <div id="questions-view" style="display: none;">
                <button id="back-to-chapters" class="btn btn-secondary">Back to Chapters</button>
                <h3 id="student-chapter-title">Chapter Title</h3>
                <div id="student-questions-list" class="questions-list">
                    <!-- Questions will be dynamically added here -->
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page">
            <div class="content-area">
                <h2>Settings</h2>
                <div class="settings-options">
                    <div class="settings-option" id="add-admin-option">
                        <h3>Add New Staff</h3>
                        <p>Create new staff accounts with admin privileges</p>
                    </div>
                    <div class="settings-option" id="add-student-option">
                        <h3>Add New Student</h3>
                        <p>Register new students for the application</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add New Admin Page -->
        <div id="add-admin-page" class="page">
            <div class="content-area">
                <h2>Add New Staff</h2>
                <div class="form-container">
                    <div class="form-group">
                        <label for="new-admin-username">Username</label>
                        <input type="text" id="new-admin-username" class="form-control" placeholder="Enter username">
                    </div>
                    <div class="form-group">
                        <label for="new-admin-password">Password</label>
                        <input type="password" id="new-admin-password" class="form-control" placeholder="Enter password">
                    </div>
                    <button class="btn" id="save-admin-btn">Create Staff Account</button>
                    <button class="btn btn-secondary" id="back-to-settings">Back to Settings</button>
                </div>
            </div>
        </div>

        <!-- Add New Student Page -->
        <div id="add-student-page" class="page">
            <div class="content-area">
                <h2>Add New Student</h2>
                <div class="form-container">
                    <div class="form-group">
                        <label for="student-class">Class</label>
                        <input type="text" id="student-class" class="form-control" placeholder="Enter class">
                    </div>
                    <div class="form-group">
                        <label for="student-name">Name</label>
                        <input type="text" id="student-name" class="form-control" placeholder="Enter student name">
                    </div>
                    <div class="form-group">
                        <label for="student-school">School Name</label>
                        <input type="text" id="student-school" class="form-control" placeholder="Enter school name">
                    </div>
                    <div class="form-group">
                        <label for="student-address">Address</label>
                        <textarea id="student-address" class="form-control" rows="3" placeholder="Enter address"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="student-mobile">Mobile Number</label>
                        <input type="text" id="student-mobile" class="form-control" placeholder="Enter mobile number">
                    </div>
                    <div class="form-group">
                        <label for="student-username">Username</label>
                        <input type="text" id="student-username" class="form-control" placeholder="Enter username">
                    </div>
                    <div class="form-group">
                        <label for="student-password">Password</label>
                        <input type="password" id="student-password" class="form-control" placeholder="Enter password">
                    </div>
                    <button class="btn" id="save-student-btn">Create Student Account</button>
                    <button class="btn btn-secondary" id="back-to-settings-student">Back to Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Share Options -->
    <div class="modal" id="share-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Share Question</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p>What would you like to share?</p>
            <button id="share-question-only" class="btn btn-secondary" style="margin-right: 10px;">Question Only</button>
            <button id="share-question-solution" class="btn btn-success">Question with Solution</button>
        </div>
    </div>

    <script>
        // Enhanced data structure with user authentication
        let appData = {
            chapters: [
                {
                    id: 1,
                    title: "Algebra",
                    sections: [
                        {
                            id: 1,
                            title: "Linear Equations",
                            questions: [
                                {
                                    id: 1,
                                    number: "1.1",
                                    question: "Solve the equation: 2x + 5 = 15",
                                    solution: "Subtract 5 from both sides: 2x = 10. Divide both sides by 2: x = 5.",
                                    image: null
                                },
                                {
                                    id: 2,
                                    number: "1.2",
                                    question: "Factorize: x² - 5x + 6",
                                    solution: "Find two numbers that multiply to 6 and add to -5: -2 and -3. So, x² - 5x + 6 = (x-2)(x-3).",
                                    image: null
                                }
                            ]
                        }
                    ]
                },
                {
                    id: 2,
                    title: "Geometry",
                    sections: [
                        {
                            id: 2,
                            title: "Triangles",
                            questions: [
                                {
                                    id: 3,
                                    number: "2.1",
                                    question: "Find the area of a triangle with base 10cm and height 5cm.",
                                    solution: "Area = 1/2 × base × height = 1/2 × 10 × 5 = 25 cm².",
                                    image: null
                                }
                            ]
                        }
                    ]
                }
            ],
            users: {
                admins: [
                    {
                        id: 1,
                        username: "Supreet_Mishra",
                        password: "Sup₹€€t21",
                        isFirstAdmin: true
                    }
                ],
                students: []
            },
            currentUser: null,
            currentChapter: null,
            currentQuestion: null,
            selectedRole: null
        };

        // DOM Elements
        const roleDropdown = document.getElementById('role-dropdown');
        const roleSelect = document.getElementById('role-select');
        const roleSubmitBtn = document.getElementById('role-submit-btn');
        const loginForm = document.getElementById('login-form');
        const loginTitle = document.getElementById('login-title');
        const loginUsername = document.getElementById('login-username');
        const loginPassword = document.getElementById('login-password');
        const loginBtn = document.getElementById('login-btn');
        const backToRoleBtn = document.getElementById('back-to-role');
        
        const adminDashboard = document.getElementById('admin-dashboard');
        const studentDashboard = document.getElementById('student-dashboard');
        const settingsPage = document.getElementById('settings-page');
        const addAdminPage = document.getElementById('add-admin-page');
        const addStudentPage = document.getElementById('add-student-page');
        
        const menuToggle = document.getElementById('menu-toggle');
        const menu = document.getElementById('menu');
        const menuLogout = document.getElementById('menu-logout');
        const menuSettings = document.getElementById('menu-settings');
        const menuHome = document.getElementById('menu-home');
        
        // Settings options
        const addAdminOption = document.getElementById('add-admin-option');
        const addStudentOption = document.getElementById('add-student-option');
        const saveAdminBtn = document.getElementById('save-admin-btn');
        const backToSettingsBtn = document.getElementById('back-to-settings');
        const saveStudentBtn = document.getElementById('save-student-btn');
        const backToSettingsStudentBtn = document.getElementById('back-to-settings-student');
        
        // New Admin Dashboard Elements
        const addChapterBtn = document.getElementById('addChapterBtn');
        const addSectionBtn = document.getElementById('addSectionBtn');
        const addQuestionBtn = document.getElementById('addQuestionBtn');
        const defaultView = document.getElementById('defaultView');
        const addChapterForm = document.getElementById('addChapterForm');
        const addSectionForm = document.getElementById('addSectionForm');
        const addQuestionForm = document.getElementById('addQuestionForm');
        const saveChapterBtn = document.getElementById('saveChapterBtn');
        const cancelChapterBtn = document.getElementById('cancelChapterBtn');
        const saveSectionBtn = document.getElementById('saveSectionBtn');
        const cancelSectionBtn = document.getElementById('cancelSectionBtn');
        const saveQuestionBtn = document.getElementById('saveQuestionBtn');
        const cancelQuestionBtn = document.getElementById('cancelQuestionBtn');
        const chapterList = document.getElementById('chapterList');
        const sectionChapterSelect = document.getElementById('sectionChapterSelect');
        const questionChapterSelect = document.getElementById('questionChapterSelect');
        const questionSectionSelect = document.getElementById('questionSectionSelect');
        
        const studentChapters = document.getElementById('student-chapters');

        const questionsView = document.getElementById('questions-view');
        const backToChapters = document.getElementById('back-to-chapters');
        const studentChapterTitle = document.getElementById('student-chapter-title');
        const studentQuestionsList = document.getElementById('student-questions-list');
        
        const shareModal = document.getElementById('share-modal');
        
        const questionImageInput = document.getElementById('questionImage');
        const imagePreview = document.getElementById('imagePreview');

        // Event Listeners
        roleSubmitBtn.addEventListener('click', handleRoleSelection);
        loginBtn.addEventListener('click', handleLogin);
        backToRoleBtn.addEventListener('click', backToRoleSelection);
        menuToggle.addEventListener('click', toggleMenu);
        menuLogout.addEventListener('click', logout);
        menuSettings.addEventListener('click', showSettings);
        menuHome.addEventListener('click', showHome);
        
        // Settings event listeners
        addAdminOption.addEventListener('click', showAddAdminPage);
        addStudentOption.addEventListener('click', showAddStudentPage);
        saveAdminBtn.addEventListener('click', saveNewAdmin);
        backToSettingsBtn.addEventListener('click', backToSettings);
        saveStudentBtn.addEventListener('click', saveNewStudent);
        backToSettingsStudentBtn.addEventListener('click', backToSettings);
        
        // Close menu when clicking anywhere on the screen
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.menu') && !e.target.closest('.menu-toggle')) {
                menu.classList.remove('active');
            }
        });
        
        // New Admin Dashboard Event Listeners
        addChapterBtn.addEventListener('click', showAddChapterForm);
        addSectionBtn.addEventListener('click', showAddSectionForm);
        addQuestionBtn.addEventListener('click', showAddQuestionForm);
        saveChapterBtn.addEventListener('click', saveChapter);
        cancelChapterBtn.addEventListener('click', hideAllForms);
        saveSectionBtn.addEventListener('click', saveSection);
        cancelSectionBtn.addEventListener('click', hideAllForms);
        saveQuestionBtn.addEventListener('click', saveQuestion);
        cancelQuestionBtn.addEventListener('click', hideAllForms);
        backToChapters.addEventListener('click', showStudentChapters);
        
        // Close modals when clicking the close button
        document.querySelectorAll('.close-modal').forEach(button => {
            button.addEventListener('click', function() {
                this.closest('.modal').classList.remove('active');
            });
        });

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // Image upload preview
        questionImageInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.classList.add('active');
                };
                reader.readAsDataURL(file);
            } else {
                imagePreview.classList.remove('active');
            }
        });

        // Functions
        function handleRoleSelection() {
            const selectedRole = roleSelect.value;
            
            if (!selectedRole) {
                alert('Please select a role');
                return;
            }
            
            appData.selectedRole = selectedRole;
            loginTitle.textContent = `Login as ${selectedRole.charAt(0).toUpperCase() + selectedRole.slice(1)}`;
            document.querySelector('.role-select').style.display = 'none';
            document.getElementById('role-submit-btn').style.display = 'none';
            loginForm.classList.add('active');
        }

        function backToRoleSelection() {
            appData.selectedRole = null;
            document.querySelector('.role-select').style.display = 'block';
            document.getElementById('role-submit-btn').style.display = 'block';
            loginForm.classList.remove('active');
            loginUsername.value = '';
            loginPassword.value = '';
        }

        function handleLogin() {
            const username = loginUsername.value.trim();
            const password = loginPassword.value.trim();
            
            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }
            
            if (appData.selectedRole === 'admin') {
                const admin = appData.users.admins.find(a => a.username === username && a.password === password);
                if (admin) {
                    appData.currentUser = {
                        username: admin.username,
                        role: 'admin',
                        isFirstAdmin: admin.isFirstAdmin || false
                    };
                    loginSuccess();
                } else {
                    alert('Invalid admin credentials');
                }
            } else if (appData.selectedRole === 'student') {
                const student = appData.users.students.find(s => s.username === username && s.password === password);
                if (student) {
                    appData.currentUser = {
                        username: student.username,
                        role: 'student',
                        studentInfo: student
                    };
                    loginSuccess();
                } else {
                    alert('Invalid student credentials');
                }
            }
        }

        function loginSuccess() {
            roleDropdown.style.display = 'none';
            
            if (appData.currentUser.role === 'admin') {
                adminDashboard.classList.add('active-page');
                renderAdminChapters();
                
                // Hide add admin option if not first admin
                if (!appData.currentUser.isFirstAdmin) {
                    addAdminOption.style.display = 'none';
                }
            } else {
                studentDashboard.classList.add('active-page');
                renderStudentChapters();
            }
        }

        function logout() {
            appData.currentUser = null;
            appData.selectedRole = null;
            adminDashboard.classList.remove('active-page');
            studentDashboard.classList.remove('active-page');
            settingsPage.classList.remove('active-page');
            addAdminPage.classList.remove('active-page');
            addStudentPage.classList.remove('active-page');
            roleDropdown.style.display = 'flex';
            menu.classList.remove('active');
            
            // Reset to role selection
            backToRoleSelection();
            
            // Reset to chapters view for student
            questionsView.style.display = 'none';
            studentChapters.style.display = 'grid';
        }

        function toggleMenu() {
            menu.classList.toggle('active');
        }

        function showSettings() {
            hideAllPages();
            settingsPage.classList.add('active-page');
            menu.classList.remove('active');
        }

        function showHome() {
            hideAllPages();
            if (appData.currentUser.role === 'admin') {
                adminDashboard.classList.add('active-page');
            } else {
                studentDashboard.classList.add('active-page');
            }
            menu.classList.remove('active');
        }

        function hideAllPages() {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
        }

        function showAddAdminPage() {
            if (!appData.currentUser.isFirstAdmin) {
                alert('Only the first admin can add new staff members');
                return;
            }
            hideAllPages();
            addAdminPage.classList.add('active-page');
        }

        function showAddStudentPage() {
            hideAllPages();
            addStudentPage.classList.add('active-page');
        }

        function backToSettings() {
            hideAllPages();
            settingsPage.classList.add('active-page');
        }

        function saveNewAdmin() {
            const username = document.getElementById('new-admin-username').value.trim();
            const password = document.getElementById('new-admin-password').value.trim();
            
            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }
            
            // Check if username already exists
            if (appData.users.admins.some(a => a.username === username) || 
                appData.users.students.some(s => s.username === username)) {
                alert('Username already exists');
                return;
            }
            
            const newAdmin = {
                id: appData.users.admins.length + 1,
                username: username,
                password: password,
                isFirstAdmin: false
            };
            
            appData.users.admins.push(newAdmin);
            alert('Staff account created successfully');
            document.getElementById('new-admin-username').value = '';
            document.getElementById('new-admin-password').value = '';
            backToSettings();
        }

        function saveNewStudent() {
            const studentClass = document.getElementById('student-class').value.trim();
            const name = document.getElementById('student-name').value.trim();
            const school = document.getElementById('student-school').value.trim();
            const address = document.getElementById('student-address').value.trim();
            const mobile = document.getElementById('student-mobile').value.trim();
            const username = document.getElementById('student-username').value.trim();
            const password = document.getElementById('student-password').value.trim();
            
            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }
            
            // Check if username already exists
            if (appData.users.admins.some(a => a.username === username) || 
                appData.users.students.some(s => s.username === username)) {
                alert('Username already exists');
                return;
            }
            
            const newStudent = {
                id: appData.users.students.length + 1,
                class: studentClass,
                name: name,
                school: school,
                address: address,
                mobile: mobile,
                username: username,
                password: password
            };
            
            appData.users.students.push(newStudent);
            alert('Student account created successfully');
            
            // Reset form
            document.getElementById('student-class').value = '';
            document.getElementById('student-name').value = '';
            document.getElementById('student-school').value = '';
            document.getElementById('student-address').value = '';
            document.getElementById('student-mobile').value = '';
            document.getElementById('student-username').value = '';
            document.getElementById('student-password').value = '';
            
            backToSettings();
        }

        // New Admin Dashboard Functions
        function showAddChapterForm() {
            hideAllForms();
            addChapterForm.classList.remove('hidden');
            addChapterForm.classList.add('active-form');
        }
        
        function showAddSectionForm() {
            if (appData.chapters.length === 0) {
                alert('Please add at least one chapter first!');
                return;
            }
            
            hideAllForms();
            addSectionForm.classList.remove('hidden');
            addSectionForm.classList.add('active-form');
            
            // Update chapter select options
            updateSectionChapterSelect();
        }
        
        function showAddQuestionForm() {
            if (appData.chapters.length === 0) {
                alert('Please add at least one chapter first!');
                return;
            }
            
            hideAllForms();
            addQuestionForm.classList.remove('hidden');
            addQuestionForm.classList.add('active-form');
            
            // Update chapter select options
            updateQuestionChapterSelect();
            updateQuestionSectionSelect();
        }
        
        function hideAllForms() {
            addChapterForm.classList.add('hidden');
            addSectionForm.classList.add('hidden');
            addQuestionForm.classList.add('hidden');
            defaultView.classList.remove('hidden');
        }
        
        function saveChapter() {
            const chapterName = document.getElementById('chapterName').value.trim();
            
            if (chapterName === '') {
                alert('Please enter a chapter name!');
                return;
            }
            
            // Create new chapter object
            const newChapter = {
                id: appData.chapters.length > 0 ? Math.max(...appData.chapters.map(ch => ch.id)) + 1 : 1,
                title: chapterName,
                sections: []
            };
            
            // Add to chapters array
            appData.chapters.push(newChapter);
            
            // Update UI
            renderAdminChapters();
            
            // Reset form and hide
            document.getElementById('chapterName').value = '';
            hideAllForms();
            
            alert('Chapter added successfully!');
        }
        
        function saveSection() {
            const chapterId = parseInt(sectionChapterSelect.value);
            const sectionName = document.getElementById('sectionName').value.trim();
            
            if (sectionName === '') {
                alert('Please enter a section name!');
                return;
            }
            
            // Find the selected chapter
            const chapter = appData.chapters.find(ch => ch.id === chapterId);
            if (!chapter) {
                alert('Selected chapter not found!');
                return;
            }
            
            // Create new section object
            const newSection = {
                id: chapter.sections.length > 0 ? Math.max(...chapter.sections.map(s => s.id)) + 1 : 1,
                title: sectionName,
                questions: []
            };
            
            // Add to sections array
            chapter.sections.push(newSection);
            
            // Reset form and hide
            document.getElementById('sectionName').value = '';
            hideAllForms();
            
            alert('Section added successfully!');
        }
        
        function saveQuestion() {
            const chapterId = parseInt(questionChapterSelect.value);
            const sectionId = parseInt(questionSectionSelect.value);
            const questionNumber = document.getElementById('questionNumber').value.trim();
            const questionText = document.getElementById('questionText').value.trim();
            const answerText = document.getElementById('answerText').value.trim();
            const imageFile = document.getElementById('questionImage').files[0];
            
            if (questionNumber === '' || questionText === '' || answerText === '') {
                alert('Please fill in all required fields!');
                return;
            }
            
            // Find the selected chapter
            const chapter = appData.chapters.find(ch => ch.id === chapterId);
            if (!chapter) {
                alert('Selected chapter not found!');
                return;
            }
            
            // Find the selected section
            const section = chapter.sections.find(s => s.id === sectionId);
            if (!section) {
                alert('Selected section not found!');
                return;
            }
            
            // Create new question object
            const newQuestion = {
                id: section.questions.length > 0 ? 
                    Math.max(...section.questions.map(q => q.id)) + 1 : 1,
                number: questionNumber,
                question: questionText,
                solution: answerText,
                image: null
            };
            
            // Handle image upload
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    newQuestion.image = e.target.result;
                    section.questions.push(newQuestion);
                    hideAllForms();
                    resetQuestionForm();
                    alert('Question added successfully!');
                };
                reader.readAsDataURL(imageFile);
            } else {
                section.questions.push(newQuestion);
                hideAllForms();
                resetQuestionForm();
                alert('Question added successfully!');
            }
        }
        
        function resetQuestionForm() {
            document.getElementById('questionNumber').value = '';
            document.getElementById('questionText').value = '';
            document.getElementById('answerText').value = '';
            document.getElementById('questionImage').value = '';
            imagePreview.classList.remove('active');
        }
        
        function renderAdminChapters() {
            chapterList.innerHTML = '';
            
            if (appData.chapters.length === 0) {
                chapterList.innerHTML = '<p>No chapters added yet. Click "Add New Chapter" to get started.</p>';
                return;
            }
            
            appData.chapters.forEach(chapter => {
                const chapterItem = document.createElement('div');
                chapterItem.className = 'chapter-item';
                chapterItem.innerHTML = `
                    <div class="chapter-title">${chapter.title}</div>
                    <div class="action-icons">
                        <button class="icon-btn" onclick="editChapter(${chapter.id})">✏️</button>
                        <button class="icon-btn" onclick="deleteChapter(${chapter.id})">🗑️</button>
                    </div>
                `;
                chapterList.appendChild(chapterItem);
            });
        }
        
        function updateSectionChapterSelect() {
            sectionChapterSelect.innerHTML = '';
            
            appData.chapters.forEach(chapter => {
                const option = document.createElement('option');
                option.value = chapter.id;
                option.textContent = chapter.title;
                sectionChapterSelect.appendChild(option);
            });
        }
        
        function updateQuestionChapterSelect() {
            questionChapterSelect.innerHTML = '';
            
            appData.chapters.forEach(chapter => {
                const option = document.createElement('option');
                option.value = chapter.id;
                option.textContent = chapter.title;
                questionChapterSelect.appendChild(option);
            });
        }
        
        function updateQuestionSectionSelect() {
            questionSectionSelect.innerHTML = '';
            
            const chapterId = parseInt(questionChapterSelect.value);
            const chapter = appData.chapters.find(ch => ch.id === chapterId);
            
            if (chapter) {
                chapter.sections.forEach(section => {
                    const option = document.createElement('option');
                    option.value = section.id;
                    option.textContent = section.title;
                    questionSectionSelect.appendChild(option);
                });
            }
        }
        
        // Placeholder functions for edit and delete
        function editChapter(id) {
            const chapter = appData.chapters.find(ch => ch.id === id);
            if (chapter) {
                document.getElementById('chapterName').value = chapter.title;
                showAddChapterForm();
                
                // Change save button to update
                saveChapterBtn.textContent = 'Update Chapter';
                saveChapterBtn.onclick = function() {
                    updateChapter(id);
                };
            }
        }
        
        function updateChapter(id) {
            const chapterName = document.getElementById('chapterName').value.trim();
            
            if (chapterName === '') {
                alert('Please enter a chapter name!');
                return;
            }
            
            const chapter = appData.chapters.find(ch => ch.id === id);
            if (chapter) {
                chapter.title = chapterName;
                renderAdminChapters();
                hideAllForms();
                
                // Reset save button
                saveChapterBtn.textContent = 'Save Chapter';
                saveChapterBtn.onclick = saveChapter;
                
                alert('Chapter updated successfully!');
            }
        }
        
        function deleteChapter(id) {
            if (confirm('Are you sure you want to delete this chapter?')) {
                appData.chapters = appData.chapters.filter(chapter => chapter.id !== id);
                renderAdminChapters();
                alert('Chapter deleted successfully!');
            }
        }

        function renderStudentChapters() {
            studentChapters.innerHTML = '';
            
            appData.chapters.forEach(chapter => {
                const chapterCard = document.createElement('div');
                chapterCard.className = 'student-chapter-card';
                chapterCard.innerHTML = `
                    <h3>${chapter.title}</h3>
                    <p>${chapter.sections.reduce((total, section) => total + section.questions.length, 0)} questions</p>
                `;
                chapterCard.addEventListener('click', function() {
                    showStudentQuestions(chapter.id);
                });
                studentChapters.appendChild(chapterCard);
            });
        }

        function showStudentQuestions(chapterId) {
            const chapter = appData.chapters.find(ch => ch.id === chapterId);
            if (chapter) {
                studentChapters.style.display = 'none';
                questionsView.style.display = 'block';
                studentChapterTitle.textContent = chapter.title;
                
                studentQuestionsList.innerHTML = '';
                
                chapter.sections.forEach(section => {
                    section.questions.forEach(question => {
                        const questionItem = document.createElement('div');
                        questionItem.className = 'student-question-item';
                        questionItem.innerHTML = `
                            <div class="student-question-header">
                                <span class="question-number">${question.number}</span>
                                <span class="solution-toggle">Show Solution</span>
                            </div>
                            <div class="question-text">${question.question}</div>
                            <div class="student-solution">
                                <strong>Solution:</strong> ${question.solution}
                                ${question.image ? `<img src="${question.image}" class="image-preview">` : ''}
                                <div class="remark-section">
                                    <button class="remark-btn">Add Remark</button>
                                    <div class="comment-form">
                                        <textarea placeholder="Enter your comment"></textarea>
                                        <button class="btn btn-success send-remark">Send</button>
                                    </div>
                                    <button class="btn btn-secondary share-question" style="margin-top: 10px;">Share Question</button>
                                    <div class="share-options">
                                        <p>What would you like to share?</p>
                                        <button class="btn btn-secondary share-question-only">Question Only</button>
                                        <button class="btn btn-success share-question-solution">Question with Solution</button>
                                    </div>
                                </div>
                            </div>
                        `;
                        studentQuestionsList.appendChild(questionItem);
                        
                        // Add event listeners for student interactions
                        const solutionToggle = questionItem.querySelector('.solution-toggle');
                        const solution = questionItem.querySelector('.student-solution');
                        const remarkBtn = questionItem.querySelector('.remark-btn');
                        const commentForm = questionItem.querySelector('.comment-form');
                        const sendRemark = questionItem.querySelector('.send-remark');
                        const shareBtn = questionItem.querySelector('.share-question');
                        const shareOptions = questionItem.querySelector('.share-options');
                        const shareQuestionOnly = questionItem.querySelector('.share-question-only');
                        const shareQuestionSolution = questionItem.querySelector('.share-question-solution');
                        
                        solutionToggle.addEventListener('click', function() {
                            solution.classList.toggle('active');
                            this.textContent = solution.classList.contains('active') ? 'Hide Solution' : 'Show Solution';
                        });
                        
                        remarkBtn.addEventListener('click', function() {
                            commentForm.classList.toggle('active');
                        });
                        
                        sendRemark.addEventListener('click', function() {
                            const comment = commentForm.querySelector('textarea').value.trim();
                            if (comment) {
                                alert('Remark sent to admin!');
                                commentForm.querySelector('textarea').value = '';
                                commentForm.classList.remove('active');
                            } else {
                                alert('Please enter a comment');
                            }
                        });
                        
                        shareBtn.addEventListener('click', function() {
                            shareOptions.classList.toggle('active');
                        });
                        
                        shareQuestionOnly.addEventListener('click', function() {
                            alert('Question shared (question only)');
                            shareOptions.classList.remove('active');
                        });
                        
                        shareQuestionSolution.addEventListener('click', function() {
                            alert('Question shared (with solution)');
                            shareOptions.classList.remove('active');
                        });
                    });
                });
            }
        }

        function showStudentChapters() {
            questionsView.style.display = 'none';
            studentChapters.style.display = 'grid';
        }

        // Initialize the app
        function init() {
            // Show role selection dropdown on page load
            roleDropdown.style.display = 'flex';
            
            // Render initial chapters
            renderAdminChapters();
            
            // Add event listener for chapter selection in question form
            questionChapterSelect.addEventListener('change', updateQuestionSectionSelect);
        }

        init();
    </script>
</body>
</html>
